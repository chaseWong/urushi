define("Promise",[],function(){"use strict";var e=function(){};return e}),define("Deferred",["Promise"],function(e){"use strict";var n,r={CLASS_NAME:"Deferred",STATUS_PROGRESS:0,STATUS_RESOLVED:1,STATUS_REJECTED:2,MESSAGE_FULLFILED:"Process was already finished."},t=function(e,n,r){var t={0:"progress",1:"resolve",2:"reject"};e&&!e.isCanceled()&&t[n]&&e[t[n]](r)},i=function(e,n){return function(r){t(e,n,r)}},S=function(e,n,S){var u,s=e&&e[n],c=e&&e.deferred;if(!s)return void t(c,n,S);try{if(u=s(S),r.STATUS_PROGRESS===n){if(!u)return;return void t(c,r.STATUS_PROGRESS,u)}if(!u||"function"!=typeof u.then)return void t(c,r.STATUS_RESOLVED,u);e.cancel=u.cancel,u.then(i(c,r.STATUS_RESOLVED),i(c,r.STATUS_REJECTED),i(c,r.STATUS_PROGRESS))}catch(o){t(c,r.STATUS_REJECTED,o)}},u=function(e,n,r){var t;for(t=0;t<e.length;t++)S(e[t],n,r)};return n=function(t){var i,s,c,o,E=r.STATUS_PROGRESS,f=!1,l=[],T=function(e,n){if(n)throw new Error(r.MESSAGE_FULLFILED);return e=e||function(){},E||e(),i};this.promise=i=new e,this.isResolved=function(){return r.STATUS_RESOLVED===E},this.isRejected=function(){return r.STATUS_REJECTED===E},this.isCanceled=function(){return f},this.isFulfilled=function(){return!!E},this.progress=function(e,n){return T(function(){u(l,r.STATUS_PROGRESS,e,null)},n)},this.resolve=function(e,n){return T(function(){E=r.STATUS_RESOLVED,s=e,u(l,r.STATUS_RESOLVED,e,null),l=null},n)},this.reject=c=function(e,n){return T(function(){E=r.STATUS_REJECTED,s=e,u(l,r.STATUS_REJECTED,e,null),l=null},n)},this.then=o=function(e,r,t){var u=[t,e,r];return u.cancel=i.cancel,u.deferred=new n(function(e){return u.cancel(e)}),E&&!l?S(u,E,s):l.push(u),u.deferred.promise},this.always=function(e){return o(e,e)},this.otherwise=function(e){return o(null,e)},this.cancel=function(e,n){var S;if(n)throw new Error(r.MESSAGE_FULLFILED);return E?null:(t&&(S=t(e),e=S?S:e),f=!0,E?("undefined"==typeof e&&(e=new Error("非同期処理がキャンセルされました。 理由は不明です。")),c(e),e):E===r.STATUS_REJECTED&&s===e?e:i.freeze?(i.freeze(),null):null)},i.isResolved=this.isResolved,i.isRejected=this.isRejected,i.isFulfilled=this.isFulfilled,i.isCanceled=this.isCanceled,i.then=this.then,i.always=this.always,i.otherwise=this.otherwise,i.cancel=this.cancel}});